<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCTV Management System by Company X</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f2f2f2;
        }
        #title_old {
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
            color: #333;
        }

        #title {
            font-size: 30px; /* Increased font size */
            font-family:Verdana, sans-serif;
            font-weight: bold;
            margin: 8px 0;
            color: #c6172f; /* Changed color to a nice blue */
            background-color: #c9c9c9; /* Added background color */
            padding: 7px; /* Added padding for spacing */
            border-radius: 10px; /* Rounded corners for elegance */
        }

        #cameraContainer {
            width: 68%;
            height: 50%;
            max-width: 70%;
            max-height: 50%;
            margin: auto;
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }
        #cameraVideo {
            width: 100%;
            height: 100%;
            border-radius: 15px;
            display: block;
        }
        #cameraPlaceholder {
            width: 100%;
            height: auto;
            border-radius: 15px;
            display: none;
        }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 12px;
            color: #333;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 5px 10px;
            border-radius:15px;
        }
        #powerToggleButton {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 5px;
            background-color: rgb(50, 95, 50); 
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
        }
        #powerToggleButton:hover {
            background-color: red;
        }
        .camera-off #cameraVideo {
            display: none;
        }
        .camera-off #cameraPlaceholder {
            display: block;
        }
    </style>
</head>
<body>
    <div id="title">CCTV Management System | </div>
    <button id="powerToggleButton"><i class="fa fa-power-off" aria-hidden="true"></i></button>
    <div id="cameraContainer">
        <!-- Replaced the image with a video tag -->
        <video id="cameraVideo" autoplay muted loop>
            <source src="/static/doha.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        <img src="/static/black.png" alt="Camera Off" id="cameraPlaceholder">
        <div id="info">Camera Status: Active | Date and Time: <span id='currentDateTime'>{{ current_time }}</span> | Location: </div>
    </div>

    <script>
        // Function to update date/time every second
        setInterval(function() {
            var currentDate = new Date();
            var dateString = currentDate.toLocaleString();
            document.getElementById("currentDateTime").innerText = dateString;
        }, 1000);

        // Function to mimic camera shutter effect
        function mimicCameraShutter() {
            var cameraVideo = document.getElementById("cameraContainer");
            cameraVideo.style.display = "none"; // Hide camera video
            setTimeout(function() {
                cameraVideo.style.display = "block"; // Show camera video after delay
            }, 100);
        }

        // Function to handle power-toggle button click
        var powerToggleButton = document.getElementById("powerToggleButton");
        powerToggleButton.addEventListener("click", function() {
            var cameraContainer = document.getElementById("cameraContainer");
            var infoDiv = document.getElementById("info");
            var cameraVideo = document.getElementById("cameraVideo");
            var cameraPlaceholder = document.getElementById("cameraPlaceholder");

            if (cameraContainer.classList.contains("camera-off")) {
                cameraContainer.classList.remove("camera-off");
                infoDiv.innerHTML = "Camera Status: Active | Date and Time: <span id='currentDateTime'>{{ current_time }}</span> | Location: A Block Lab, Riphah University";
                cameraVideo.style.display = "block";
                cameraPlaceholder.style.display = "none";

                // Send request to Flask backend to log camera action (turning on)
                var formDataOn = new FormData();
                formDataOn.append("action", "camera-on");
                fetch("/camera-action", {
                    method: "POST",
                    body: formDataOn
                });
            } else {
                cameraContainer.classList.add("camera-off");
                infoDiv.innerHTML = "Camera Status: Off";
                cameraVideo.style.display = "none";
                cameraPlaceholder.style.display = "block";

                // Send request to Flask backend to log camera action (turning off)
                var formDataOff = new FormData();
                formDataOff.append("action", "camera-off");
                fetch("/camera-action", {
                    method: "POST",
                    body: formDataOff
                });
            }
        });
    </script>
</body>
</html>
